---
title: "High Seas Chinook Catch"
output: html_document
---

```{r loadData, echo=FALSE, warning=FALSE}
library(tidyverse); library(ggplot2)

chin <- read.csv(here::here("data", "highSeas", "cleanChinook.csv"),
                 stringsAsFactors = FALSE) %>% 
  mutate(month =  fct_relevel(as.factor(month), "FEB", "MAR", "APR", "MAY", 
                              "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC")
         ) %>% 
  filter(lat < 55)

source(here::here("R", "functions", "hotMapFunc.R"))
```

## Summary of Chinook catches in High Seas Salmon program (`r min(chin$year)` - `r max(chin$year)`)

This summary is focused on the west coast of Vancouver Island and four major stock aggregates: Columbia River (spring/summer), Fraser River, WCVI and Puget Sound.

### Columbia River distribution

Columbia River spring and summer shown here include the following aggregates: mid-Columbia spring, Upper Columbia spring and summer/fall, Snake spring/summer, and Upper Willamette. These stocks are most abundant off NW WCVI in June and southern Haida Gwaii in July. Seems to be consistent with Trudel et al. 2009 and Tucker et al. 2012 characterization of rapid migration north. Unclear when smaller size classes in Feb./March entered because they seem to be too small to be ocean age-1, but too early/big to be ocean age-0.

```{r columbia, echo=FALSE, warning=FALSE}
# chin %>%
#   filter(agg == "COLUMBIA-SNAKE") %>%
#   select(reg) %>%
#   distinct()

juvCR <- chin %>% 
  # focus on spring/summer run
  filter(reg %in% c("MID COL-SP", "UP COL-SP", "UPPER COLUMBIA-SP", 
                    "UPPER COLUMBIA-SU/F", "MID COLUMBIA-SP", "SNAKE-SP/SU",
                    "UPPER WILLAMETTE", "UP WILLAMETTE"),
         fl < 400)

hotMap(juvCR, longRange = c(-135, -124.5), latRange = c(48, 55.5), 
       facet = "month")
```

```{r colHist, echo = FALSE, warning = FALSE}
ggplot(juvCR, aes(x = fl)) +
  geom_histogram() +
  facet_wrap(~month, scales = "free_y")
```


### West Coast Vancouver Island distribution

West Coast Vancouver Island stocks are predominantly concentrated in northern portion of the island around Quatsino Sound with considerable numbers also captured in Queen Charlotte Sound. Surprisingly few caught further south closer to major ocean entry locations. Migration is also substantially more protracted than Columbia River fish. Fair number of ocean age 2 fish captured in June and July suggesting some local residence.

```{r wcvi, echo=FALSE, warning=FALSE}
juvWCVI <- chin %>% 
  filter(reg %in% c("WCVI"),
         fl < 400)

hotMap(juvWCVI, longRange = c(-135, -124.5), latRange = c(48, 55.5), 
       facet = "month")
```

```{r wcviHist, echo = FALSE, warning = FALSE}
ggplot(juvWCVI, aes(x = fl)) +
  geom_histogram() +
  facet_wrap(~month, scales = "free_y")
```

### Puget Sound distribution

Puget Sound stocks seems to have the most southerly distributibution with concentrations close to Juan de Fuca Strait. Size distributions are consistent with most movements out of Salish Sea overwinter (note some small fish caught in summer though) and then residence off the southern coast of Vancouver Island.

```{r pugSound, echo=FALSE, warning=FALSE}
juvPS <- chin %>% 
  filter(reg %in% c("PUGET SOUND"),
         fl < 400)

hotMap(juvPS, longRange = c(-135, -124.5), latRange = c(48, 55.5), 
       facet = "month")
```

```{r psHist, echo = FALSE, warning = FALSE}
ggplot(juvPS, aes(x = fl)) +
  geom_histogram() +
  facet_wrap(~month, scales = "free_y")
```


### Fraser River distribution

Similar to Puget Sound, spatial and size data suggest fish exit Strait after fall sampling (exceptions may be interior fish if they behave like Columbia River but too few caught to tell). Substantial differences among stocks in catches and distribution can be seen in maps in "highSeasCatch/stockSpecific" directory.

```{r fraser, echo=FALSE, warning=FALSE}
chin %>%
  filter(agg == "FRASER") %>%
  select(reg) %>%
  distinct()

juvFR <- chin %>% 
  filter(agg == "FRASER",
         fl < 400)

hotMap(juvFR, longRange = c(-135, -124.5), latRange = c(48, 55.5), 
       facet = "month")
```

```{r psHist, echo = FALSE, warning = FALSE}
ggplot(juvFR, aes(x = fl)) +
  geom_histogram() +
  facet_wrap(~month, scales = "free_y")
```